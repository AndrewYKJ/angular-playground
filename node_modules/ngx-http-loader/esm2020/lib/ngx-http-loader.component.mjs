import { Component, Input } from '@angular/core';
import { merge, timer } from 'rxjs';
import { switchMap, debounce, distinctUntilChanged, tap, partition } from 'rxjs/operators';
import { NgxLoader } from './ngx-http-loader';
import * as i0 from "@angular/core";
import * as i1 from "./ngx-loader-interceptor.service";
import * as i2 from "./ngx-http-loader.service";
import * as i3 from "@angular/platform-browser";
import * as i4 from "@angular/common";
import * as i5 from "./loaders/gear-loader/gear-loader.component";
import * as i6 from "./loaders/grid-loader/grid-loader.component";
import * as i7 from "./loaders/dual-ring-loader/dual-ring-loader.component";
import * as i8 from "./loaders/clock-loader/clock-loader.component";
import * as i9 from "./loaders/default-loader/default-loader.component";
import * as i10 from "./loaders/ellipsis-loader/ellipsis-loader.component";
import * as i11 from "./loaders/facebook-loader/facebook-loader.component";
import * as i12 from "./loaders/heart-loader/heart-loader.component";
import * as i13 from "./loaders/hourglass-loader/hourglass-loader.component";
import * as i14 from "./loaders/ring-loader/ring-loader.component";
import * as i15 from "./loaders/ripple-loader/ripple-loader.component";
import * as i16 from "./loaders/roller-loader/roller-loader.component";
import * as i17 from "./loaders/spinner-loader/spinner-loader.component";
import * as i18 from "./loaders/water-wave-loader/water-wave-loader.component";
import * as i19 from "./loaders/three-bounce-loader/three-bounce-loader.component";
import * as i20 from "./loaders/multicircle-loader/multicircle-loader.component";
import * as i21 from "./loaders/jellybox-loader/jellybox-loader.component";
import * as i22 from "./loaders/rotating-plane/rotating-plane.component";
export class NgxHttpLoaderComponent {
    constructor(requestService, service, sanitizer) {
        this.requestService = requestService;
        this.service = service;
        this.sanitizer = sanitizer;
        this.customEnumLoader = NgxLoader;
        this.loader = NgxLoader.RIPPLE;
        this.filterUrlRegexPatterns = [];
        this.filterUrls = [];
        this.filterHttpHeaders = [];
        this.filterHttpMethods = [];
        this.delay = 0;
        this.extraDelay = 0;
        this.minDuration = 0;
        this.opacity = 0.8;
        // @Input() public backdropBackgroundColor = 'linear-gradient(45deg, #222428, #444856)';
        // @Input() public backdropBackgroundColor = 'transperent';
        this.backdropBackgroundColor = 'linear-gradient(0deg, black, transparent);';
        this.iconColor = 'white';
        this.title = '';
        this.titleColor = '#fff';
        this.titleSize = '3rem';
        this.subTitle = '';
        this.subTitleColor = '#6c757d';
        this.subTitleSize = '1.2rem';
        this.custom = false;
        this.showuntil = Date.now();
    }
    ngOnChanges(changes) {
        if (this.filterUrlRegexPatterns.length > 0 || this.filterUrls.length > 0
            || this.filterHttpHeaders.length > 0 || this.filterHttpMethods.length > 0)
            this.initAllFilters();
    }
    ngOnInit() {
        this.initAllFilters();
    }
    initAllFilters() {
        this.requestService.setUrlPatterns = this.filterUrlRegexPatterns;
        this.requestService.setFilterUrls = this.filterUrls;
        this.requestService.setFilterMethods = this.filterHttpMethods;
        this.requestService.setFilterHeaders = this.filterHttpHeaders;
        this.initShowObservable();
    }
    initShowObservable() {
        const [show, hide] = partition(($hide) => $hide)(this.requestService.reqStatus);
        this.show$ = merge(this.requestService.reqStatus.pipe(switchMap(() => show.pipe(debounce(() => timer(this.delay))))), show.pipe(switchMap(() => hide.pipe(debounce(() => this.showUpto())))), this.service.isShowLoader).pipe(distinctUntilChanged(), tap(x => this.updateHideDelay(x)));
    }
    updateHideDelay(bool) {
        if (bool)
            this.showuntil = Date.now() + this.minDuration;
    }
    showUpto() {
        return timer(Math.max(this.extraDelay, this.showuntil - Date.now()));
    }
}
NgxHttpLoaderComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.0.1", ngImport: i0, type: NgxHttpLoaderComponent, deps: [{ token: i1.NgxHttpLoaderInterceptor }, { token: i2.NgxHttpLoaderService }, { token: i3.DomSanitizer }], target: i0.ɵɵFactoryTarget.Component });
NgxHttpLoaderComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.0.1", type: NgxHttpLoaderComponent, selector: "ngx-http-loader", inputs: { customTemplate: "customTemplate", customLoader: "customLoader", loader: "loader", filterUrlRegexPatterns: "filterUrlRegexPatterns", filterUrls: "filterUrls", filterHttpHeaders: "filterHttpHeaders", filterHttpMethods: "filterHttpMethods", delay: "delay", extraDelay: "extraDelay", minDuration: "minDuration", opacity: "opacity", backdropBackgroundColor: "backdropBackgroundColor", iconColor: "iconColor", title: "title", titleColor: "titleColor", titleSize: "titleSize", subTitle: "subTitle", subTitleColor: "subTitleColor", subTitleSize: "subTitleSize", custom: "custom" }, usesOnChanges: true, ngImport: i0, template: "<div *ngIf=\"show$ | async\">\r\n    <ng-template [ngTemplateOutlet]=\"customTemplate || defaultTemplate\"></ng-template>\r\n    <ng-template #defaultTemplate>\r\n        <div class=\"custom-loader vertical-center\"\r\n            [attr.style]=\"sanitizer.bypassSecurityTrustStyle('--background-color: ' + backdropBackgroundColor + '; opacity :' + opacity)\">\r\n            <div class=\"custom-loader-section text-light\"\r\n                [attr.style]=\"sanitizer.bypassSecurityTrustStyle('--iconcolor: ' + iconColor)\">\r\n                <ng-container *ngIf=\"custom\">\r\n                    <ng-template [ngTemplateOutlet]=\"customLoader\"></ng-template>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"!custom\">\r\n                    <lib-gear-loader *ngIf=\"loader === customEnumLoader.GEAR\"></lib-gear-loader>\r\n                    <lib-grid-loader *ngIf=\"loader === customEnumLoader.GRID\"></lib-grid-loader>\r\n                    <lib-dual-ring-loader *ngIf=\"loader === customEnumLoader.DUALRING\"></lib-dual-ring-loader>\r\n                    <lib-clock-loader *ngIf=\"loader === customEnumLoader.CLOCK\"></lib-clock-loader>\r\n                    <lib-default-loader *ngIf=\"loader === customEnumLoader.DEFAULT\"></lib-default-loader>\r\n                    <lib-ellipsis-loader *ngIf=\"loader === customEnumLoader.ELLIPSIS\"></lib-ellipsis-loader>\r\n                    <lib-spinner-loader *ngIf=\"loader === customEnumLoader.SPINNER\"></lib-spinner-loader>\r\n                    <lib-facebook-loader *ngIf=\"loader === customEnumLoader.FACEBOOK\"></lib-facebook-loader>\r\n                    <lib-heart-loader *ngIf=\"loader === customEnumLoader.HEART\"></lib-heart-loader>\r\n                    <lib-hourglass-loader *ngIf=\"loader === customEnumLoader.HOURGLASS\"></lib-hourglass-loader>\r\n                    <lib-ring-loader *ngIf=\"loader === customEnumLoader.RING\"></lib-ring-loader>\r\n                    <lib-ripple-loader *ngIf=\"loader === customEnumLoader.RIPPLE\"></lib-ripple-loader>\r\n                    <lib-roller-loader *ngIf=\"loader === customEnumLoader.ROLLER\"></lib-roller-loader>\r\n                    <lib-water-wave-loader *ngIf=\"loader === customEnumLoader.WATERWAVE\"></lib-water-wave-loader>\r\n                    <lib-multicircle-loader *ngIf=\"loader === customEnumLoader.MULTICIRCLE\"></lib-multicircle-loader>\r\n                    <lib-three-bounce-loader *ngIf=\"loader === customEnumLoader.THREEBOUNCE\"></lib-three-bounce-loader>\r\n                    <lib-jellybox-loader *ngIf=\"loader === customEnumLoader.JELLYBOX\"></lib-jellybox-loader>\r\n                    <lib-rotating-plane *ngIf=\"loader === customEnumLoader.ROTATINGPLANE\"></lib-rotating-plane>\r\n                </ng-container>\r\n                <h1 *ngIf=\"title\" class=\"font-weight-bold text-shadow\"\r\n                    style=\"font-family:Trebuchet MS,Helvetica,sans-serif; width: 50%; margin: 10px auto; margin-top: 20px; word-break: break-all;\"\r\n                    [style.color]=\"titleColor\" [style.fontSize]=\"titleSize\">\r\n                    {{title}}\r\n                </h1>\r\n                <div style=\"width: 50%; margin: 10px auto; word-break: break-all;\" *ngIf=\"subTitle\"\r\n                    [style.color]=\"subTitleColor\" [style.fontSize]=\"subTitleSize\">{{subTitle}}</div>\r\n            </div>\r\n        </div>\r\n    </ng-template>\r\n</div>", styles: [".custom-loader{position:fixed;top:0;left:0;width:100%;height:100%;background:var(--background-color);color:#fff;z-index:99999;transition:all .3s linear}.custom-loader .custom-loader-section{text-align:center;width:100%;color:#f8f9fa}.custom-loader ::ng-deep>*{vertical-align:middle;white-space:normal;display:inline-block;z-index:99999999999}.vertical-center:before{content:\"\";display:inline-block;vertical-align:middle;width:0;height:100%}\n"], dependencies: [{ kind: "directive", type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i4.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: i5.GearLoaderComponent, selector: "lib-gear-loader" }, { kind: "component", type: i6.GridLoaderComponent, selector: "lib-grid-loader" }, { kind: "component", type: i7.DualRingLoaderComponent, selector: "lib-dual-ring-loader" }, { kind: "component", type: i8.ClockLoaderComponent, selector: "lib-clock-loader" }, { kind: "component", type: i9.DefaultLoaderComponent, selector: "lib-default-loader" }, { kind: "component", type: i10.EllipsisLoaderComponent, selector: "lib-ellipsis-loader" }, { kind: "component", type: i11.FacebookLoaderComponent, selector: "lib-facebook-loader" }, { kind: "component", type: i12.HeartLoaderComponent, selector: "lib-heart-loader" }, { kind: "component", type: i13.HourglassLoaderComponent, selector: "lib-hourglass-loader" }, { kind: "component", type: i14.RingLoaderComponent, selector: "lib-ring-loader" }, { kind: "component", type: i15.RippleLoaderComponent, selector: "lib-ripple-loader" }, { kind: "component", type: i16.RollerLoaderComponent, selector: "lib-roller-loader" }, { kind: "component", type: i17.SpinnerLoaderComponent, selector: "lib-spinner-loader" }, { kind: "component", type: i18.WaterWaveLoaderComponent, selector: "lib-water-wave-loader" }, { kind: "component", type: i19.ThreeBounceLoaderComponent, selector: "lib-three-bounce-loader" }, { kind: "component", type: i20.MulticircleLoaderComponent, selector: "lib-multicircle-loader" }, { kind: "component", type: i21.JellyboxLoaderComponent, selector: "lib-jellybox-loader" }, { kind: "component", type: i22.RotatingPlaneComponent, selector: "lib-rotating-plane" }, { kind: "pipe", type: i4.AsyncPipe, name: "async" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.0.1", ngImport: i0, type: NgxHttpLoaderComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ngx-http-loader', template: "<div *ngIf=\"show$ | async\">\r\n    <ng-template [ngTemplateOutlet]=\"customTemplate || defaultTemplate\"></ng-template>\r\n    <ng-template #defaultTemplate>\r\n        <div class=\"custom-loader vertical-center\"\r\n            [attr.style]=\"sanitizer.bypassSecurityTrustStyle('--background-color: ' + backdropBackgroundColor + '; opacity :' + opacity)\">\r\n            <div class=\"custom-loader-section text-light\"\r\n                [attr.style]=\"sanitizer.bypassSecurityTrustStyle('--iconcolor: ' + iconColor)\">\r\n                <ng-container *ngIf=\"custom\">\r\n                    <ng-template [ngTemplateOutlet]=\"customLoader\"></ng-template>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"!custom\">\r\n                    <lib-gear-loader *ngIf=\"loader === customEnumLoader.GEAR\"></lib-gear-loader>\r\n                    <lib-grid-loader *ngIf=\"loader === customEnumLoader.GRID\"></lib-grid-loader>\r\n                    <lib-dual-ring-loader *ngIf=\"loader === customEnumLoader.DUALRING\"></lib-dual-ring-loader>\r\n                    <lib-clock-loader *ngIf=\"loader === customEnumLoader.CLOCK\"></lib-clock-loader>\r\n                    <lib-default-loader *ngIf=\"loader === customEnumLoader.DEFAULT\"></lib-default-loader>\r\n                    <lib-ellipsis-loader *ngIf=\"loader === customEnumLoader.ELLIPSIS\"></lib-ellipsis-loader>\r\n                    <lib-spinner-loader *ngIf=\"loader === customEnumLoader.SPINNER\"></lib-spinner-loader>\r\n                    <lib-facebook-loader *ngIf=\"loader === customEnumLoader.FACEBOOK\"></lib-facebook-loader>\r\n                    <lib-heart-loader *ngIf=\"loader === customEnumLoader.HEART\"></lib-heart-loader>\r\n                    <lib-hourglass-loader *ngIf=\"loader === customEnumLoader.HOURGLASS\"></lib-hourglass-loader>\r\n                    <lib-ring-loader *ngIf=\"loader === customEnumLoader.RING\"></lib-ring-loader>\r\n                    <lib-ripple-loader *ngIf=\"loader === customEnumLoader.RIPPLE\"></lib-ripple-loader>\r\n                    <lib-roller-loader *ngIf=\"loader === customEnumLoader.ROLLER\"></lib-roller-loader>\r\n                    <lib-water-wave-loader *ngIf=\"loader === customEnumLoader.WATERWAVE\"></lib-water-wave-loader>\r\n                    <lib-multicircle-loader *ngIf=\"loader === customEnumLoader.MULTICIRCLE\"></lib-multicircle-loader>\r\n                    <lib-three-bounce-loader *ngIf=\"loader === customEnumLoader.THREEBOUNCE\"></lib-three-bounce-loader>\r\n                    <lib-jellybox-loader *ngIf=\"loader === customEnumLoader.JELLYBOX\"></lib-jellybox-loader>\r\n                    <lib-rotating-plane *ngIf=\"loader === customEnumLoader.ROTATINGPLANE\"></lib-rotating-plane>\r\n                </ng-container>\r\n                <h1 *ngIf=\"title\" class=\"font-weight-bold text-shadow\"\r\n                    style=\"font-family:Trebuchet MS,Helvetica,sans-serif; width: 50%; margin: 10px auto; margin-top: 20px; word-break: break-all;\"\r\n                    [style.color]=\"titleColor\" [style.fontSize]=\"titleSize\">\r\n                    {{title}}\r\n                </h1>\r\n                <div style=\"width: 50%; margin: 10px auto; word-break: break-all;\" *ngIf=\"subTitle\"\r\n                    [style.color]=\"subTitleColor\" [style.fontSize]=\"subTitleSize\">{{subTitle}}</div>\r\n            </div>\r\n        </div>\r\n    </ng-template>\r\n</div>", styles: [".custom-loader{position:fixed;top:0;left:0;width:100%;height:100%;background:var(--background-color);color:#fff;z-index:99999;transition:all .3s linear}.custom-loader .custom-loader-section{text-align:center;width:100%;color:#f8f9fa}.custom-loader ::ng-deep>*{vertical-align:middle;white-space:normal;display:inline-block;z-index:99999999999}.vertical-center:before{content:\"\";display:inline-block;vertical-align:middle;width:0;height:100%}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.NgxHttpLoaderInterceptor }, { type: i2.NgxHttpLoaderService }, { type: i3.DomSanitizer }]; }, propDecorators: { customTemplate: [{
                type: Input
            }], customLoader: [{
                type: Input
            }], loader: [{
                type: Input
            }], filterUrlRegexPatterns: [{
                type: Input
            }], filterUrls: [{
                type: Input
            }], filterHttpHeaders: [{
                type: Input
            }], filterHttpMethods: [{
                type: Input
            }], delay: [{
                type: Input
            }], extraDelay: [{
                type: Input
            }], minDuration: [{
                type: Input
            }], opacity: [{
                type: Input
            }], backdropBackgroundColor: [{
                type: Input
            }], iconColor: [{
                type: Input
            }], title: [{
                type: Input
            }], titleColor: [{
                type: Input
            }], titleSize: [{
                type: Input
            }], subTitle: [{
                type: Input
            }], subTitleColor: [{
                type: Input
            }], subTitleSize: [{
                type: Input
            }], custom: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWh0dHAtbG9hZGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1odHRwLWxvYWRlci9zcmMvbGliL25neC1odHRwLWxvYWRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtaHR0cC1sb2FkZXIvc3JjL2xpYi9uZ3gtaHR0cC1sb2FkZXIuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQWlELE1BQU0sZUFBZSxDQUFDO0FBQ2hHLE9BQU8sRUFBRSxLQUFLLEVBQWMsS0FBSyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2hELE9BQU8sRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLG9CQUFvQixFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUUzRixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQVM5QyxNQUFNLE9BQU8sc0JBQXNCO0lBNkJqQyxZQUNVLGNBQXdDLEVBQ3pDLE9BQTZCLEVBQzdCLFNBQXVCO1FBRnRCLG1CQUFjLEdBQWQsY0FBYyxDQUEwQjtRQUN6QyxZQUFPLEdBQVAsT0FBTyxDQUFzQjtRQUM3QixjQUFTLEdBQVQsU0FBUyxDQUFjO1FBOUJ6QixxQkFBZ0IsR0FBRyxTQUFTLENBQUM7UUFHcEIsV0FBTSxHQUFrQixTQUFTLENBQUMsTUFBTSxDQUFDO1FBQ3pDLDJCQUFzQixHQUFhLEVBQUUsQ0FBQztRQUN0QyxlQUFVLEdBQWEsRUFBRSxDQUFDO1FBQzFCLHNCQUFpQixHQUFhLEVBQUUsQ0FBQztRQUNqQyxzQkFBaUIsR0FBYSxFQUFFLENBQUM7UUFDakMsVUFBSyxHQUFHLENBQUMsQ0FBQztRQUNWLGVBQVUsR0FBRyxDQUFDLENBQUM7UUFDZixnQkFBVyxHQUFHLENB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QUFDOzttSEFwRVUsc0JBQXNCO3VHQUF0QixzQkFBc0Isb3BCQ2JuQyxpNEdBd0NNOzJGRDNCTyxzQkFBc0I7a0JBTGxDLFNBQVM7K0JBQ0UsaUJBQWlCOzZLQU9YLGNBQWM7c0JBQTdCLEtBQUs7Z0JBQ1UsWUFBWTtzQkFBM0IsS0FBSztnQkFDVSxNQUFNO3NCQUFyQixLQUFLO2dCQUNVLHNCQUFzQjtzQkFBckMsS0FBSztnQkFDVSxVQUFVO3NCQUF6QixLQUFLO2dCQUNVLGlCQUFpQjtzQkFBaEMsS0FBSztnQkFDVSxpQkFBaUI7c0JBQWhDLEtBQUs7Z0JBQ1UsS0FBSztzQkFBcEIsS0FBSztnQkFDVSxVQUFVO3NCQUF6QixLQUFLO2dCQUNVLFdBQVc7c0JBQTFCLEtBQUs7Z0JBQ1UsT0FBTztzQkFBdEIsS0FBSztnQkFHVSx1QkFBdUI7c0JBQXRDLEtBQUs7Z0JBQ1UsU0FBUztzQkFBeEIsS0FBSztnQkFDVSxLQUFLO3NCQUFwQixLQUFLO2dCQUNVLFVBQVU7c0JBQXpCLEtBQUs7Z0JBQ1UsU0FBUztzQkFBeEIsS0FBSztnQkFDVSxRQUFRO3NCQUF2QixLQUFLO2dCQUNVLGFBQWE7c0JBQTVCLEtBQUs7Z0JBQ1UsWUFBWTtzQkFBM0IsS0FBSztnQkFDVSxNQUFNO3NCQUFyQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0LCBPbkNoYW5nZXMsIFRlbXBsYXRlUmVmLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBtZXJnZSwgT2JzZXJ2YWJsZSwgdGltZXIgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHN3aXRjaE1hcCwgZGVib3VuY2UsIGRpc3RpbmN0VW50aWxDaGFuZ2VkLCB0YXAsIHBhcnRpdGlvbiB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IE5neEh0dHBMb2FkZXJJbnRlcmNlcHRvciB9IGZyb20gJy4vbmd4LWxvYWRlci1pbnRlcmNlcHRvci5zZXJ2aWNlJztcbmltcG9ydCB7IE5neExvYWRlciB9IGZyb20gJy4vbmd4LWh0dHAtbG9hZGVyJztcbmltcG9ydCB7IE5neEh0dHBMb2FkZXJTZXJ2aWNlIH0gZnJvbSAnLi9uZ3gtaHR0cC1sb2FkZXIuc2VydmljZSc7XG5pbXBvcnQgeyBEb21TYW5pdGl6ZXIgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LWh0dHAtbG9hZGVyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL25neC1odHRwLWxvYWRlci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL25neC1odHRwLWxvYWRlci5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIE5neEh0dHBMb2FkZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuXG4gIHB1YmxpYyBjdXN0b21FbnVtTG9hZGVyID0gTmd4TG9hZGVyO1xuICBASW5wdXQoKSBwdWJsaWMgY3VzdG9tVGVtcGxhdGUhOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBASW5wdXQoKSBwdWJsaWMgY3VzdG9tTG9hZGVyITogVGVtcGxhdGVSZWY8YW55PjtcbiAgQElucHV0KCkgcHVibGljIGxvYWRlcjogc3RyaW5nIHwgbnVsbCA9IE5neExvYWRlci5SSVBQTEU7XG4gIEBJbnB1dCgpIHB1YmxpYyBmaWx0ZXJVcmxSZWdleFBhdHRlcm5zOiBSZWdFeHBbXSA9IFtdO1xuICBASW5wdXQoKSBwdWJsaWMgZmlsdGVyVXJsczogc3RyaW5nW10gPSBbXTtcbiAgQElucHV0KCkgcHVibGljIGZpbHRlckh0dHBIZWFkZXJzOiBzdHJpbmdbXSA9IFtdO1xuICBASW5wdXQoKSBwdWJsaWMgZmlsdGVySHR0cE1ldGhvZHM6IHN0cmluZ1tdID0gW107XG4gIEBJbnB1dCgpIHB1YmxpYyBkZWxheSA9IDA7XG4gIEBJbnB1dCgpIHB1YmxpYyBleHRyYURlbGF5ID0gMDtcbiAgQElucHV0KCkgcHVibGljIG1pbkR1cmF0aW9uID0gMDtcbiAgQElucHV0KCkgcHVibGljIG9wYWNpdHk6IG51bWJlciA9IDAuODtcbiAgLy8gQElucHV0KCkgcHVibGljIGJhY2tkcm9wQmFja2dyb3VuZENvbG9yID0gJ2xpbmVhci1ncmFkaWVudCg0NWRlZywgIzIyMjQyOCwgIzQ0NDg1NiknO1xuICAvLyBASW5wdXQoKSBwdWJsaWMgYmFja2Ryb3BCYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwZXJlbnQnO1xuICBASW5wdXQoKSBwdWJsaWMgYmFja2Ryb3BCYWNrZ3JvdW5kQ29sb3IgPSAnbGluZWFyLWdyYWRpZW50KDBkZWcsIGJsYWNrLCB0cmFuc3BhcmVudCk7JztcbiAgQElucHV0KCkgcHVibGljIGljb25Db2xvcjogc3RyaW5nID0gJ3doaXRlJztcbiAgQElucHV0KCkgcHVibGljIHRpdGxlOiBzdHJpbmcgPSAnJztcbiAgQElucHV0KCkgcHVibGljIHRpdGxlQ29sb3I6IHN0cmluZyA9ICcjZmZmJztcbiAgQElucHV0KCkgcHVibGljIHRpdGxlU2l6ZTogc3RyaW5nID0gJzNyZW0nO1xuICBASW5wdXQoKSBwdWJsaWMgc3ViVGl0bGU6IHN0cmluZyA9ICcnO1xuICBASW5wdXQoKSBwdWJsaWMgc3ViVGl0bGVDb2xvcjogc3RyaW5nID0gJyM2Yzc1N2QnO1xuICBASW5wdXQoKSBwdWJsaWMgc3ViVGl0bGVTaXplOiBzdHJpbmcgPSAnMS4ycmVtJztcbiAgQElucHV0KCkgcHVibGljIGN1c3RvbTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHB1YmxpYyBzaG93JCE6IE9ic2VydmFibGU8Ym9vbGVhbj47XG4gIHByaXZhdGUgc2hvd3VudGlsID0gRGF0ZS5ub3coKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlcXVlc3RTZXJ2aWNlOiBOZ3hIdHRwTG9hZGVySW50ZXJjZXB0b3IsXG4gICAgcHVibGljIHNlcnZpY2U6IE5neEh0dHBMb2FkZXJTZXJ2aWNlLFxuICAgIHB1YmxpYyBzYW5pdGl6ZXI6IERvbVNhbml0aXplclxuICApIHtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5maWx0ZXJVcmxSZWdleFBhdHRlcm5zLmxlbmd0aCA+IDAgfHwgdGhpcy5maWx0ZXJVcmxzLmxlbmd0aCA+IDBcbiAgICAgIHx8IHRoaXMuZmlsdGVySHR0cEhlYWRlcnMubGVuZ3RoID4gMCB8fCB0aGlzLmZpbHRlckh0dHBNZXRob2RzLmxlbmd0aCA+IDApIHRoaXMuaW5pdEFsbEZpbHRlcnMoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuaW5pdEFsbEZpbHRlcnMoKTtcbiAgfVxuXG4gIGluaXRBbGxGaWx0ZXJzKCkge1xuICAgIHRoaXMucmVxdWVzdFNlcnZpY2Uuc2V0VXJsUGF0dGVybnMgPSB0aGlzLmZpbHRlclVybFJlZ2V4UGF0dGVybnM7XG4gICAgdGhpcy5yZXF1ZXN0U2VydmljZS5zZXRGaWx0ZXJVcmxzID0gdGhpcy5maWx0ZXJVcmxzO1xuICAgIHRoaXMucmVxdWVzdFNlcnZpY2Uuc2V0RmlsdGVyTWV0aG9kcyA9IHRoaXMuZmlsdGVySHR0cE1ldGhvZHM7XG4gICAgdGhpcy5yZXF1ZXN0U2VydmljZS5zZXRGaWx0ZXJIZWFkZXJzID0gdGhpcy5maWx0ZXJIdHRwSGVhZGVycztcbiAgICB0aGlzLmluaXRTaG93T2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgaW5pdFNob3dPYnNlcnZhYmxlKCkge1xuICAgIGNvbnN0IFtzaG93LCBoaWRlXSA9IHBhcnRpdGlvbigoJGhpZGU6IGJvb2xlYW4pID0+ICRoaWRlKSh0aGlzLnJlcXVlc3RTZXJ2aWNlLnJlcVN0YXR1cyk7XG4gICAgdGhpcy5zaG93JCA9IG1lcmdlKFxuICAgICAgdGhpcy5yZXF1ZXN0U2VydmljZS5yZXFTdGF0dXMucGlwZShzd2l0Y2hNYXAoKCkgPT4gc2hvdy5waXBlKGRlYm91bmNlKCgpID0+IHRpbWVyKHRoaXMuZGVsYXkpKSkpKSxcbiAgICAgIHNob3cucGlwZShzd2l0Y2hNYXAoKCkgPT4gaGlkZS5waXBlKGRlYm91bmNlKCgpID0+IHRoaXMuc2hvd1VwdG8oKSkpKSksXG4gICAgICB0aGlzLnNlcnZpY2UuaXNTaG93TG9hZGVyXG4gICAgKS5waXBlKGRpc3RpbmN0VW50aWxDaGFuZ2VkKCksIHRhcCh4ID0+IHRoaXMudXBkYXRlSGlkZURlbGF5KHgpKSlcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlSGlkZURlbGF5KGJvb2w6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBpZiAoYm9vbCkgdGhpcy5zaG93dW50aWwgPSBEYXRlLm5vdygpICsgdGhpcy5taW5EdXJhdGlvbjtcbiAgfVxuXG4gIHByaXZhdGUgc2hvd1VwdG8oKTogT2JzZXJ2YWJsZTxudW1iZXI+IHtcbiAgICByZXR1cm4gdGltZXIoTWF0aC5tYXgodGhpcy5leHRyYURlbGF5LCB0aGlzLnNob3d1bnRpbCAtIERhdGUubm93KCkpKTtcbiAgfVxuXG59XG4iLCI8ZGl2ICpuZ0lmPVwic2hvdyQgfCBhc3luY1wiPlxyXG4gICAgPG5nLXRlbXBsYXRlIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImN1c3RvbVRlbXBsYXRlIHx8IGRlZmF1bHRUZW1wbGF0ZVwiPjwvbmctdGVtcGxhdGU+XHJcbiAgICA8bmctdGVtcGxhdGUgI2RlZmF1bHRUZW1wbGF0ZT5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwiY3VzdG9tLWxvYWRlciB2ZXJ0aWNhbC1jZW50ZXJcIlxyXG4gICAgICAgICAgICBbYXR0ci5zdHlsZV09XCJzYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdFN0eWxlKCctLWJhY2tncm91bmQtY29sb3I6ICcgKyBiYWNrZHJvcEJhY2tncm91bmRDb2xvciArICc7IG9wYWNpdHkgOicgKyBvcGFjaXR5KVwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3VzdG9tLWxvYWRlci1zZWN0aW9uIHRleHQtbGlnaHRcIlxyXG4gICAgICAgICAgICAgICAgW2F0dHIuc3R5bGVdPVwic2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RTdHlsZSgnLS1pY29uY29sb3I6ICcgKyBpY29uQ29sb3IpXCI+XHJcbiAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiY3VzdG9tXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImN1c3RvbUxvYWRlclwiPjwvbmctdGVtcGxhdGU+XHJcbiAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCIhY3VzdG9tXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxpYi1nZWFyLWxvYWRlciAqbmdJZj1cImxvYWRlciA9PT0gY3VzdG9tRW51bUxvYWRlci5HRUFSXCI+PC9saWItZ2Vhci1sb2FkZXI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxpYi1ncmlkLWxvYWRlciAqbmdJZj1cImxvYWRlciA9PT0gY3VzdG9tRW51bUxvYWRlci5HUklEXCI+PC9saWItZ3JpZC1sb2FkZXI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxpYi1kdWFsLXJpbmctbG9hZGVyICpuZ0lmPVwibG9hZGVyID09PSBjdXN0b21FbnVtTG9hZGVyLkRVQUxSSU5HXCI+PC9saWItZHVhbC1yaW5nLWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLWNsb2NrLWxvYWRlciAqbmdJZj1cImxvYWRlciA9PT0gY3VzdG9tRW51bUxvYWRlci5DTE9DS1wiPjwvbGliLWNsb2NrLWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLWRlZmF1bHQtbG9hZGVyICpuZ0lmPVwibG9hZGVyID09PSBjdXN0b21FbnVtTG9hZGVyLkRFRkFVTFRcIj48L2xpYi1kZWZhdWx0LWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLWVsbGlwc2lzLWxvYWRlciAqbmdJZj1cImxvYWRlciA9PT0gY3VzdG9tRW51bUxvYWRlci5FTExJUFNJU1wiPjwvbGliLWVsbGlwc2lzLWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLXNwaW5uZXItbG9hZGVyICpuZ0lmPVwibG9hZGVyID09PSBjdXN0b21FbnVtTG9hZGVyLlNQSU5ORVJcIj48L2xpYi1zcGlubmVyLWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLWZhY2Vib29rLWxvYWRlciAqbmdJZj1cImxvYWRlciA9PT0gY3VzdG9tRW51bUxvYWRlci5GQUNFQk9PS1wiPjwvbGliLWZhY2Vib29rLWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLWhlYXJ0LWxvYWRlciAqbmdJZj1cImxvYWRlciA9PT0gY3VzdG9tRW51bUxvYWRlci5IRUFSVFwiPjwvbGliLWhlYXJ0LWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLWhvdXJnbGFzcy1sb2FkZXIgKm5nSWY9XCJsb2FkZXIgPT09IGN1c3RvbUVudW1Mb2FkZXIuSE9VUkdMQVNTXCI+PC9saWItaG91cmdsYXNzLWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLXJpbmctbG9hZGVyICpuZ0lmPVwibG9hZGVyID09PSBjdXN0b21FbnVtTG9hZGVyLlJJTkdcIj48L2xpYi1yaW5nLWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLXJpcHBsZS1sb2FkZXIgKm5nSWY9XCJsb2FkZXIgPT09IGN1c3RvbUVudW1Mb2FkZXIuUklQUExFXCI+PC9saWItcmlwcGxlLWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLXJvbGxlci1sb2FkZXIgKm5nSWY9XCJsb2FkZXIgPT09IGN1c3RvbUVudW1Mb2FkZXIuUk9MTEVSXCI+PC9saWItcm9sbGVyLWxvYWRlcj5cclxuICAgICAgICAgICAgICAgICAgICA8bGliLXdhdGVyLXdhdmUtbG9hZGVyICpuZ0lmPVwibG9hZGVyID09PSBjdXN0b21FbnVtTG9hZGVyLldBVEVSV0FWRVwiPjwvbGliLXdhdGVyLXdhdmUtbG9hZGVyPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaWItbXVsdGljaXJjbGUtbG9hZGVyICpuZ0lmPVwibG9hZGVyID09PSBjdXN0b21FbnVtTG9hZGVyLk1VTFRJQ0lSQ0xFXCI+PC9saWItbXVsdGljaXJjbGUtbG9hZGVyPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaWItdGhyZWUtYm91bmNlLWxvYWRlciAqbmdJZj1cImxvYWRlciA9PT0gY3VzdG9tRW51bUxvYWRlci5USFJFRUJPVU5DRVwiPjwvbGliLXRocmVlLWJvdW5jZS1sb2FkZXI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxpYi1qZWxseWJveC1sb2FkZXIgKm5nSWY9XCJsb2FkZXIgPT09IGN1c3RvbUVudW1Mb2FkZXIuSkVMTFlCT1hcIj48L2xpYi1qZWxseWJveC1sb2FkZXI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxpYi1yb3RhdGluZy1wbGFuZSAqbmdJZj1cImxvYWRlciA9PT0gY3VzdG9tRW51bUxvYWRlci5ST1RBVElOR1BMQU5FXCI+PC9saWItcm90YXRpbmctcGxhbmU+XHJcbiAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgICAgIDxoMSAqbmdJZj1cInRpdGxlXCIgY2xhc3M9XCJmb250LXdlaWdodC1ib2xkIHRleHQtc2hhZG93XCJcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZT1cImZvbnQtZmFtaWx5OlRyZWJ1Y2hldCBNUyxIZWx2ZXRpY2Esc2Fucy1zZXJpZjsgd2lkdGg6IDUwJTsgbWFyZ2luOiAxMHB4IGF1dG87IG1hcmdpbi10b3A6IDIwcHg7IHdvcmQtYnJlYWs6IGJyZWFrLWFsbDtcIlxyXG4gICAgICAgICAgICAgICAgICAgIFtzdHlsZS5jb2xvcl09XCJ0aXRsZUNvbG9yXCIgW3N0eWxlLmZvbnRTaXplXT1cInRpdGxlU2l6ZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIHt7dGl0bGV9fVxyXG4gICAgICAgICAgICAgICAgPC9oMT5cclxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJ3aWR0aDogNTAlOyBtYXJnaW46IDEwcHggYXV0bzsgd29yZC1icmVhazogYnJlYWstYWxsO1wiICpuZ0lmPVwic3ViVGl0bGVcIlxyXG4gICAgICAgICAgICAgICAgICAgIFtzdHlsZS5jb2xvcl09XCJzdWJUaXRsZUNvbG9yXCIgW3N0eWxlLmZvbnRTaXplXT1cInN1YlRpdGxlU2l6ZVwiPnt7c3ViVGl0bGV9fTwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgIDwvbmctdGVtcGxhdGU+XHJcbjwvZGl2PiJdfQ==